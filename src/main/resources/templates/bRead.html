<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function () {

            var formObj = $("#board");

            $("#btModify").on("click", function() {
                var boardId = $("#boardId");
                var boardIdVal = boardId.val();

                self.location = "/modify?boardId=" + boardIdVal;
            });

            $("#btRemove").on("click", function (){
                formObj.attr("action","/remove");
                formObj.attr("method","post");
                formObj.submit();
            })
        })
    </script>
</head>
<body>

    <h2>read</h2>
    <form id="board" th:object="${board}">
        <input type="hidden"  id="boardId" name="boardId" th:value="*{boardId}"/>
        <input type="hidden" name="indexId" th:value="*{indexId}"/>
        <table>
            <tr>
                <td>title</td>
                <td><input type="text" name="title"
                           th:field="*{title}" readonly="readonly" /></td>
            </tr>
            <tr>
                <td>content</td>
                <td><input type="text" name="content"
                           th:field="*{content}" readonly="readonly" /></td>
            </tr>
            <tr>
                <td>genAddress</td>
                <td width="100%" height="100%">
                    <div id="map" style="width:100%;height:350px;">
                        <input type="hidden" name="genAddress"
                               th:field="*{genAddress}" readonly="readonly" /><
                    </div>
                </td>

            </tr>
            <tr>
                <td>detAddress</td>
                <td><input type="text" name="detAddress"
                           th:field="*{detAddress}" readonly="readonly" /></td>
            </tr>
            <tr>
                <td>updateDate</td>
                <td th:text="${#dates.format(board.updateDate,'yyyy-MM-dd')}"></td>
            </tr
            >
        </table>

    </form>
    <div>
        <button type="submit" id="btModify">수정</button>
        <button type="submit" id="btRemove">삭제</button>
    </div>
    <!-- 댓글 -->
    <div>
        <h5>댓글</h5>
        <div>
            <form name="comment-form" action="/comment/write" method="post">
                <div>
                    <input type="hidden" name="commentId">
                    <textarea name="content" >

                    </textarea>
                    <button type="submit">작성</button>
                </div>
            </form>
        </div>
    </div>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=36bff8b96636a6127542c2c517175d6f&libraries=services"></script>
    <script>
        var genAddress = "[[${board.genAddress}]]"
        var detAddress = "[[${board.detAddress}]]"
        console.log("주소는 : " + genAddress);
        var mapContainer = document.getElementById('map'), // 지도를 표시할 div
            mapOption = {
                center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
                level: 3 // 지도의 확대 레벨
            };

        // 지도를 생성합니다
        var map = new kakao.maps.Map(mapContainer, mapOption);

        // 주소-좌표 변환 객체를 생성합니다
        var geocoder = new kakao.maps.services.Geocoder();

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(genAddress, function(result, status) {

            // 정상적으로 검색이 완료됐으면
            if (status === kakao.maps.services.Status.OK) {

                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                // 결과값으로 받은 위치를 마커로 표시합니다
                var marker = new kakao.maps.Marker({
                    map: map,
                    position: coords
                });

                // 인포윈도우로 장소에 대한 설명을 표시합니다
                var infowindow = new kakao.maps.InfoWindow({
                    content: '<div style="width:150px;text-align:center;padding:6px 0;">"[[${board.detAddress}]]"</div>'
                });
                infowindow.open(map, marker);

                // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
                map.setCenter(coords);
            }
        });
    </script>
</body>
</html>